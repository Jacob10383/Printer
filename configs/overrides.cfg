[rs485_sniffer]
#═══════════════════════════════════════════════════════════════════════════════
#  TOOLCHANGER
#═══════════════════════════════════════════════════════════════════════════════
[toolchanger]
flush_speed: 20              # mm³/s volumetric flow rate
pre_flush_speed: 15          # mm³/s for pre-flush extrusion
pre_flush_length: 63         # mm to extrude before flush
default_temp: 220            # fallback temp when no gcode data
retract_length: 45           # mm to retract before cutting
spoolman_integration: true  # enable spoolman spool tracking
#═══════════════════════════════════════════════════════════════════════════════
#  CARTOGRAPHER & BED MESH
#═══════════════════════════════════════════════════════════════════════════════
[cartographer scan_model default]
coefficients: 1.4977600388832182, 1.9945762175026043, 0.8565302843687623, 0.41424149193191273, 0.3920538897421213, 0.3211516932494985, -0.19175257345787539, -0.18027970222676457, 0.24519895492881305, 0.15495431899047882
domain: 3.3113254657128317e-07, 3.432446153537827e-07
z_offset: 0
reference_temperature: 31.37
software_version: 1.3.3
mcu_version: CARTOGRAPHER V4 6.0.0
[cartographer touch_model default]
threshold: 1400
speed: 1.5
z_offset: -0.02
software_version: 1.3.3
mcu_version: CARTOGRAPHER V4 6.0.0
[cartographer touch]
samples: 3
max_samples: 15
EXPERIMENTAL_home_random_radius: 0
[cartographer scan]
mesh_height: 2
mesh_path: snake
[bed_mesh]
probe_count: 150, 75
mesh_min: 10, 10
mesh_max: 345, 335
adaptive_margin: 10
move_check_distance: 1
speed: 300
#═══════════════════════════════════════════════════════════════════════════════
#  FILAMENT Z OFFSETS
#═══════════════════════════════════════════════════════════════════════════════
[gcode_macro _START_PRINT_VARS]
variable_heat_soak: 0
variable_offset_PETG: 0.00
variable_offset_ABS: 0
variable_offset_ASA: 0
variable_offset_PLA: 0.00
variable_offset_DEFAULT: 0.00
gcode:
#═══════════════════════════════════════════════════════════════════════════════
#  INPUT SHAPER
#═══════════════════════════════════════════════════════════════════════════════
[input_shaper]
# X-axis: smooth_zv @ 54.8 Hz (vibration: 0.00%, max_accel: 10800 mm/sec²)
shaper_type_x: smooth_zv
smoother_freq_x: 49.0
# Y-axis: smooth_zv @ 49.0 Hz (vibration: 0.77%, max_accel: 8600 mm/sec²)
shaper_type_y: smooth_zv
smoother_freq_y: 49.0
pa_sync_smooth_time: manual
#═══════════════════════════════════════════════════════════════════════════════
#  TEMPERATURE CONTROL
#═══════════════════════════════════════════════════════════════════════════════
[extruder]
control: pid
pid_kp: 26.157
pid_ki: 2.813
pid_kd: 60.815
# control: mpc
# heater_power: 100
# cooling_fan: output_pin fan0
# filament_diameter: 1.75
# filament_density: 1.20
# filament_heat_capacity: 1.8
# block_heat_capacity: 18.6476
# sensor_responsiveness: 0.103627
# ambient_transfer: 0.0974936
# fan_ambient_transfer: 0.0974936, 0.150802, 0.182642
[heater_bed]
control: pid
pid_Kp: 70
pid_Ki: 0.55
pid_Kd: 1800
#═══════════════════════════════════════════════════════════════════════════════
#  MISC
#═══════════════════════════════════════════════════════════════════════════════
[virtual_sdcard]
forced_leveling: false
[box]
cut_pos_x: -6.30
#═══════════════════════════════════════════════════════════════════════════════
#  HOMING
#═══════════════════════════════════════════════════════════════════════════════
[z_align]
distance_ratio: 0.92
quick_speed: 30
slow_speed: 15
rising_dist: 3
safe_dist: 40
filter_cnt: 3
timeout: 15
retries: 3
retry_tolerance: 15
endstop_pin_z: PA15, PA8
zd_up: 0
zes_untrig: 1
zmax_safe_pox_diff: 10
[homing_override]
axes: xyz
gcode:
    MOTOR_STALL_MODE DATA=1
    M204 S500
    {% set homed = printer.toolhead.homed_axes %}
    {% if homed|length == 0 %}
        SET_GCODE_VARIABLE MACRO=xyz_ready VARIABLE=x_ready VALUE=0
        SET_GCODE_VARIABLE MACRO=xyz_ready VARIABLE=y_ready VALUE=0
        SET_GCODE_VARIABLE MACRO=xyz_ready VARIABLE=z_ready VALUE=0
        SET_GCODE_VARIABLE MACRO=xyz_ready VARIABLE=xy_moved VALUE=0
        SET_GCODE_VARIABLE MACRO=xyz_ready VARIABLE=z_moved VALUE=0
        {action_respond_info("No axes homed")}
    {% else %}
        {action_respond_info("Homed axes: %s" % homed)}
    {% endif %}
    {% if 'z' not in homed %}
        BED_MESH_CLEAR
    {% endif %}
    {% set home_all = 'X' not in params and 'Y' not in params %}
    {% if 'Z' in params and 'X' not in params and 'Y' not in params and 'x' in homed and 'y' in homed %}
        {% set home_all = false %}
    {% endif %}
    {% set x_homing = home_all or 'X' in params %}
    {% set y_homing = home_all or 'Y' in params %}
    {% if y_homing %}
        _HOME_Y
    {% endif %}
    {% if x_homing %}
        _HOME_X
    {% endif %}
    {% set x_homed_after = x_homing or 'x' in homed %}
    {% set y_homed_after = y_homing or 'y' in homed %}
    {% if (x_homing or y_homing) and x_homed_after and y_homed_after %}
        FORCE_MOVE STEPPER=stepper_y DISTANCE=-3 VELOCITY=10
    {% endif %}
    {% if home_all or 'Z' in params %}
        SET_PIN PIN=extruder_fan VALUE=0
        _HOME_Z
    {% endif %}
    BED_MESH_PROFILE LOAD="default"
    MOTOR_STALL_MODE DATA=2
    MOTOR_CHECK_PROTECTION_AFTER_HOME DATA=11
    M204 S{printer.toolhead.max_accel}
[gcode_macro PRINTER_PARAM]
variable_max_y_position: 380.0
[bed_mesh default]
version: 1
points:
    0.0, 0.0, 0.0, 0.0, 0.0
    0.0, 0.0, 0.0, 0.0, 0.0
    0.0, 0.0, 0.0, 0.0, 0.0
    0.0, 0.0, 0.0, 0.0, 0.0
    0.0, 0.0, 0.0, 0.0, 0.0
x_count: 5
y_count: 5
mesh_x_pps: 2
mesh_y_pps: 2
algo: bicubic
tension: 0.2
min_x: 5.0
max_x: 345.0
min_y: 5.0
max_y: 335.0