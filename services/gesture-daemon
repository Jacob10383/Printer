#!/bin/sh /etc/rc.common

START=98
STOP=02
USE_PROCD=1

DAEMON=/usr/bin/guppy-gesture-daemon
LOG_FILE=/tmp/gesture-daemon.log

start_service() {
    # Only start if display-server is running (not GuppyScreen)
    if ! pgrep display-server >/dev/null 2>&1; then
        echo "Gesture daemon not started (display-server not running)"
        return 0
    fi
    
    echo "Starting gesture daemon..."
    
    procd_open_instance
    procd_set_param command "$DAEMON"
    procd_set_param respawn
    procd_set_param stdout 1
    procd_set_param stderr 1
    procd_set_param file "$LOG_FILE"
    procd_close_instance
}

stop_service() {
    echo "Stopping gesture daemon..."
    killall -9 guppy-gesture-daemon 2>/dev/null || true
}
